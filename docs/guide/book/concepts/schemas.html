<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Understanding SCIM Schemas - SCIM Server Guide</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SCIM Server Guide</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="understanding-scim-schemas"><a class="header" href="#understanding-scim-schemas">Understanding SCIM Schemas</a></h1>
<p>SCIM (System for Cross-domain Identity Management) uses a sophisticated schema system to define how identity data is structured, validated, and extended across HTTP REST operations. This chapter explores the schema-centric aspects of SCIM and how they're implemented in the SCIM Server library.</p>
<h2 id="scim-protocol-background"><a class="header" href="#scim-protocol-background">SCIM Protocol Background</a></h2>
<p>SCIM is defined by two key Internet Engineering Task Force (IETF) Request for Comments (RFC) specifications:</p>
<ul>
<li><strong><a href="https://tools.ietf.org/html/rfc7643">RFC 7643: System for Cross-domain Identity Management (SCIM): Core Schema</a></strong> - Defines the core schema and extension model for representing users and groups, published September 2015</li>
<li><strong><a href="https://tools.ietf.org/html/rfc7644">RFC 7644: System for Cross-domain Identity Management (SCIM): Protocol</a></strong> - Specifies the REST API protocol for provisioning and managing identity data, published September 2015</li>
</ul>
<p>These RFCs establish SCIM 2.0 as the industry standard for identity provisioning, providing a specification for automated user lifecycle management between identity providers (like Okta, Azure AD) and service providers (applications). The schema system defined in RFC 7643 forms the foundation for all SCIM operations, ensuring consistent data representation while allowing for extensibility to meet specific organizational requirements.</p>
<h2 id="what-are-scim-schemas"><a class="header" href="#what-are-scim-schemas">What Are SCIM Schemas?</a></h2>
<p>SCIM schemas define the structure and constraints for identity resources like Users and Groups across HTTP REST operations. They serve multiple purposes:</p>
<ul>
<li><strong>Data Structure Definition</strong>: Define what attributes a resource can have</li>
<li><strong>Validation Rules</strong>: Specify required fields, data types, and constraints</li>
<li><strong>HTTP Operation Context</strong>: Guide validation and processing for GET, POST, PUT, PATCH, DELETE</li>
<li><strong>Extensibility Framework</strong>: Allow custom attributes while maintaining interoperability</li>
<li><strong>API Contract</strong>: Provide a machine-readable description of resource formats</li>
<li><strong>Meta Components</strong>: Define service provider capabilities and resource types</li>
</ul>
<h2 id="schema-structure-progression"><a class="header" href="#schema-structure-progression">Schema Structure Progression</a></h2>
<p>SCIM uses a layered approach to schema definition, progressing from meta-schemas to concrete resource schemas.</p>
<h3 id="1-schema-for-schemas-meta-schema"><a class="header" href="#1-schema-for-schemas-meta-schema">1. Schema for Schemas (Meta-Schema)</a></h3>
<p>At the foundation is the meta-schema that defines how schemas themselves are structured. This is defined in RFC 7643 Section 7 and includes attributes like:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L25-40">{
  "id": "urn:ietf:params:scim:schemas:core:2.0:Schema",
  "name": "Schema",
  "description": "Specifies the schema that describes a SCIM schema",
  "attributes": [
    {
      "name": "id",
      "type": "string",
      "multiValued": false,
      "description": "The unique URI of the schema",
      "required": true,
      "mutability": "readOnly"
    }
    // ... more meta-attributes
  ]
}
</code></pre>
<p>This meta-schema ensures consistency across all SCIM schema definitions and enables programmatic schema discovery and validation.</p>
<h3 id="2-core-resource-schemas"><a class="header" href="#2-core-resource-schemas">2. Core Resource Schemas</a></h3>
<p>SCIM defines two core resource schemas that all compliant implementations must support:</p>
<h4 id="user-schema-urnietfparamsscimschemascore20user"><a class="header" href="#user-schema-urnietfparamsscimschemascore20user">User Schema (<code>urn:ietf:params:scim:schemas:core:2.0:User</code>)</a></h4>
<p>The User schema defines standard attributes for representing people in identity systems:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L45-65">{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
  "id": "urn:ietf:params:scim:schemas:core:2.0:User",
  "name": "User",
  "description": "User Account",
  "attributes": [
    {
      "name": "userName",
      "type": "string",
      "multiValued": false,
      "description": "Unique identifier for the User",
      "required": true,
      "mutability": "readWrite",
      "returned": "default",
      "uniqueness": "server"
    },
    {
      "name": "name",
      "type": "complex",
      "multiValued": false,
      "description": "The components of the user's real name",
      "required": false,
      "subAttributes": [
        {
          "name": "formatted",
          "type": "string",
          "multiValued": false,
          "description": "The full name",
          "required": false
        },
        {
          "name": "familyName", 
          "type": "string",
          "multiValued": false,
          "description": "The family name",
          "required": false
        }
        // ... more name components
      ]
    }
    // ... more user attributes
  ]
}
</code></pre>
<p><strong>Key User Attributes:</strong></p>
<ul>
<li><code>userName</code>: Unique identifier (required)</li>
<li><code>name</code>: Complex type with formatted, family, and given names</li>
<li><code>emails</code>: Multi-valued array of email addresses</li>
<li><code>active</code>: Boolean indicating account status</li>
<li><code>groups</code>: Multi-valued references to group memberships</li>
</ul>
<h4 id="group-schema-urnietfparamsscimschemascore20group"><a class="header" href="#group-schema-urnietfparamsscimschemascore20group">Group Schema (<code>urn:ietf:params:scim:schemas:core:2.0:Group</code>)</a></h4>
<p>The Group schema defines attributes for representing collections of users:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L90-110">{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:Group"],
  "id": "urn:ietf:params:scim:schemas:core:2.0:Group", 
  "name": "Group",
  "description": "Group",
  "attributes": [
    {
      "name": "displayName",
      "type": "string",
      "multiValued": false,
      "description": "A human-readable name for the Group",
      "required": true,
      "mutability": "readWrite"
    },
    {
      "name": "members",
      "type": "complex",
      "multiValued": true,
      "description": "A list of members of the Group",
      "required": false,
      "subAttributes": [
        {
          "name": "value",
          "type": "string", 
          "multiValued": false,
          "description": "Identifier of the member",
          "mutability": "immutable"
        },
        {
          "name": "$ref",
          "type": "reference",
          "referenceTypes": ["User", "Group"],
          "multiValued": false,
          "description": "The URI of the member resource"
        }
      ]
    }
  ]
}
</code></pre>
<p><strong>Key Group Attributes:</strong></p>
<ul>
<li><code>displayName</code>: Human-readable group name (required)</li>
<li><code>members</code>: Multi-valued complex attribute containing user/group references</li>
</ul>
<h3 id="3-schema-specialization-and-extensions"><a class="header" href="#3-schema-specialization-and-extensions">3. Schema Specialization and Extensions</a></h3>
<p>SCIM's extensibility model allows organizations to add custom attributes while maintaining core compatibility.</p>
<h4 id="enterprise-user-extension"><a class="header" href="#enterprise-user-extension">Enterprise User Extension</a></h4>
<p>RFC 7643 defines a standard extension for enterprise environments:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L140-160">{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User",
    "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User"
  ],
  "userName": "john.doe",
  "emails": [{"value": "john@example.com", "primary": true}],
  "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User": {
    "employeeNumber": "12345",
    "department": "Engineering", 
    "manager": {
      "value": "26118915-6090-4610-87e4-49d8ca9f808d",
      "$ref": "../Users/26118915-6090-4610-87e4-49d8ca9f808d",
      "displayName": "Jane Smith"
    },
    "organization": "Acme Corp"
  }
}
</code></pre>
<h4 id="custom-schema-extensions"><a class="header" href="#custom-schema-extensions">Custom Schema Extensions</a></h4>
<p>Organizations can define completely custom schemas using proper URN namespacing:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L170-190">{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User",
    "urn:example:params:scim:schemas:extension:acme:2.0:User"
  ],
  "userName": "alice.engineer",
  "urn:example:params:scim:schemas:extension:acme:2.0:User": {
    "securityClearance": "SECRET",
    "projectAssignments": [
      {
        "projectId": "PROJ-001",
        "role": "Lead Developer",
        "startDate": "2024-01-15"
      }
    ],
    "skills": ["rust", "scim", "identity-management"]
  }
}
</code></pre>
<h2 id="schema-processing-in-scim-operations"><a class="header" href="#schema-processing-in-scim-operations">Schema Processing in SCIM Operations</a></h2>
<p>SCIM schemas drive all protocol operations, providing structure and validation rules that ensure consistent data handling across different identity providers and service providers.</p>
<h2 id="http-rest-operations-and-schema-processing"><a class="header" href="#http-rest-operations-and-schema-processing">HTTP REST Operations and Schema Processing</a></h2>
<p>SCIM schemas are deeply integrated with HTTP REST operations. Each SCIM command has specific schema processing requirements:</p>
<h3 id="schema-aware-http-operations"><a class="header" href="#schema-aware-http-operations">Schema-Aware HTTP Operations</a></h3>
<h4 id="get-operations---schema-driven-response-formation"><a class="header" href="#get-operations---schema-driven-response-formation">GET Operations - Schema-Driven Response Formation</a></h4>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L300-320">// GET /Users/{id} - Schema determines response structure
let user = provider.get_resource("User", &amp;user_id, &amp;context).await?;

// Schema controls:
// - Which attributes are returned by default
// - Attribute mutability affects response inclusion
// - Extension schemas determine namespace organization
// - "returned" attribute property: "always", "never", "default", "request"

{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
  "id": "2819c223-7f76-453a-919d-413861904646",
  "userName": "bjensen@example.com",  // returned: "default"
  "meta": {                           // Always included per spec
    "resourceType": "User",
    "created": "2010-01-23T04:56:22Z",
    "lastModified": "2011-05-13T04:42:34Z",
    "version": "W/\"3694e05e9dff591\"",
    "location": "https://example.com/v2/Users/2819c223..."
  }
}
</code></pre>
<h4 id="post-operations---schema-validation-on-creation"><a class="header" href="#post-operations---schema-validation-on-creation">POST Operations - Schema Validation on Creation</a></h4>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L325-345">// POST /Users - Complete resource creation with schema validation
let create_request = json!({
    "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
    "userName": "newuser@example.com",  // Required per schema
    "emails": [{"value": "newuser@example.com", "primary": true}]
});

// Schema validation includes:
// - Required attribute presence check
// - Data type validation
// - Uniqueness constraint enforcement
// - Mutability rules ("readOnly" attributes rejected)
// - Extension schema validation

let user = provider.create_resource("User", create_request, &amp;context).await?;
</code></pre>
<h4 id="put-operations---complete-resource-replacement"><a class="header" href="#put-operations---complete-resource-replacement">PUT Operations - Complete Resource Replacement</a></h4>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L350-370">// PUT /Users/{id} - Schema ensures complete resource validity
let replacement_data = json!({
    "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
    "userName": "bjensen@example.com",  // Must include all required fields
    "emails": [{"value": "bjensen@newdomain.com", "primary": true}],
    "active": true
});

// Schema processing for PUT:
// - Validates complete resource structure
// - Ensures all required attributes present
// - Respects "immutable" and "readOnly" constraints
// - Processes all registered extension schemas
</code></pre>
<h4 id="patch-operations---partial-updates-with-schema-context"><a class="header" href="#patch-operations---partial-updates-with-schema-context">PATCH Operations - Partial Updates with Schema Context</a></h4>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L375-395">use scim_server::patch::{PatchOperation, PatchOp};

// PATCH /Users/{id} - Schema-aware partial modifications
let patch_ops = vec![
    PatchOperation {
        op: PatchOp::Replace,
        path: Some("emails[primary eq true].value".to_string()),
        value: Some(json!("newemail@example.com")),
    },
    PatchOperation {
        op: PatchOp::Add,
        path: Some("urn:ietf:params:scim:schemas:extension:enterprise:2.0:User:department".to_string()),
        value: Some(json!("Engineering")),
    }
];

// Schema validation for PATCH:
// - Path expression validation against schema structure
// - Target attribute mutability checking
// - Extension schema awareness for namespaced paths
// - Multi-valued attribute handling per schema rules
</code></pre>
<h4 id="delete-operations---schema-informed-cleanup"><a class="header" href="#delete-operations---schema-informed-cleanup">DELETE Operations - Schema-Informed Cleanup</a></h4>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L410-430">// DELETE /Users/{id} - Schema guides deletion processing
// Schema-informed deletion:
// - Validates deletion permissions based on mutability constraints
// - Processes extension schema cleanup requirements
// - Determines soft delete vs hard delete approach
</code></pre>
<h2 id="scim-meta-components-and-schema-integration"><a class="header" href="#scim-meta-components-and-schema-integration">SCIM Meta Components and Schema Integration</a></h2>
<p>SCIM defines several meta-schemas that describe the service provider's capabilities and resource structures:</p>
<h3 id="service-provider-configuration-schema"><a class="header" href="#service-provider-configuration-schema">Service Provider Configuration Schema</a></h3>
<p>The ServiceProviderConfig resource describes server capabilities:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L445-465">{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:ServiceProviderConfig"],
  "documentationUri": "https://example.com/help/scim.html",
  "patch": {
    "supported": true
  },
  "bulk": {
    "supported": true,
    "maxOperations": 1000,
    "maxPayloadSize": 1048576
  },
  "filter": {
    "supported": true,
    "maxResults": 200
  },
  "changePassword": {
    "supported": false
  },
  "sort": {
    "supported": true
  },
  "etag": {
    "supported": true
  },
  "authenticationSchemes": [
    {
      "type": "oauthbearertoken",
      "name": "OAuth Bearer Token",
      "description": "Authentication scheme using the OAuth Bearer Token",
      "specUri": "http://www.rfc-editor.org/info/rfc6750",
      "documentationUri": "https://example.com/help/oauth.html"
    }
  ]
}
</code></pre>
<h3 id="resource-type-meta-schema"><a class="header" href="#resource-type-meta-schema">Resource Type Meta-Schema</a></h3>
<p>Resource types describe available SCIM resources and their schemas:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L485-505">// GET /ResourceTypes/User returns:
{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:ResourceType"],
  "id": "User",
  "name": "User",
  "endpoint": "/Users",
  "description": "User Account",
  "schema": "urn:ietf:params:scim:schemas:core:2.0:User",
  "schemaExtensions": [
    {
      "schema": "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User",
      "required": false
    },
    {
      "schema": "urn:example:params:scim:schemas:extension:acme:2.0:User", 
      "required": true
    }
  ],
  "meta": {
    "location": "https://example.com/v2/ResourceTypes/User",
    "resourceType": "ResourceType"
  }
}
</code></pre>
<h3 id="schema-meta-attributes"><a class="header" href="#schema-meta-attributes">Schema Meta-Attributes</a></h3>
<p>Every SCIM resource includes meta-attributes that support HTTP operations:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L520-540">{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
  "id": "2819c223-7f76-453a-919d-413861904646",
  "userName": "bjensen@example.com",
  "meta": {
    "resourceType": "User",                              // Schema-derived type
    "created": "2010-01-23T04:56:22Z",                  // Creation timestamp
    "lastModified": "2011-05-13T04:42:34Z",             // Modification tracking
    "location": "https://example.com/v2/Users/2819c223-7f76-453a-919d-413861904646",
    "version": "W/\"3694e05e9dff591\""                  // ETag for concurrency control
  }
}

// Meta attributes enable:
// - HTTP caching with ETags
// - Conditional operations (If-Match, If-None-Match) 
// - Audit trail capabilities
// - Resource location for HATEOAS compliance
</code></pre>
<h2 id="schema-processing-in-scim-server-implementation"><a class="header" href="#schema-processing-in-scim-server-implementation">Schema Processing in SCIM Server Implementation</a></h2>
<p>The SCIM Server library integrates schema processing throughout the HTTP request lifecycle:</p>
<h3 id="request-processing-pipeline"><a class="header" href="#request-processing-pipeline">Request Processing Pipeline</a></h3>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L555-575">use scim_server::{ScimServer, RequestContext};

let server = ScimServer::new(provider)?;

// 1. HTTP Request → Schema Identification
let schemas = extract_schemas_from_request(&amp;request_body)?;

// 2. Schema Validation → Resource Processing  
let validation_context = ValidationContext {
    schemas: &amp;schemas,
    operation: HttpOperation::Post,
    resource_type: "User",
};

// 3. Operation Execution with Schema Constraints
let result = match request.method() {
    "GET" =&gt; server.get_with_schema_filtering(&amp;resource_type, &amp;id, &amp;query_params, &amp;context).await?,
    "POST" =&gt; server.create_with_schema_validation(&amp;resource_type, &amp;request_body, &amp;context).await?,
    "PUT" =&gt; server.replace_with_schema_validation(&amp;resource_type, &amp;id, &amp;request_body, &amp;context).await?,
    "PATCH" =&gt; server.patch_with_schema_awareness(&amp;resource_type, &amp;id, &amp;patch_ops, &amp;context).await?,
    "DELETE" =&gt; server.delete_with_schema_cleanup(&amp;resource_type, &amp;id, &amp;context).await?,
};
</code></pre>
<h3 id="schema-driven-query-processing"><a class="header" href="#schema-driven-query-processing">Schema-Driven Query Processing</a></h3>
<p>SCIM query parameters interact directly with schema definitions:</p>
<pre><code>GET /Users?attributes=userName,emails&amp;filter=active eq true
</code></pre>
<p>Schema processing for queries:</p>
<ul>
<li>Validates attribute names against schema definitions</li>
<li>Handles extension schema attributes in projections</li>
<li>Enforces "returned" attribute constraints</li>
<li>Processes complex attribute path expressions</li>
<li>Validates filter expressions against attribute types</li>
</ul>
<h2 id="auto-schema-discovery"><a class="header" href="#auto-schema-discovery">Auto Schema Discovery</a></h2>
<p>SCIM Server provides automatic schema discovery capabilities that integrate with the SCIM protocol's introspection endpoints:</p>
<h3 id="schema-endpoint-implementation"><a class="header" href="#schema-endpoint-implementation">Schema Endpoint Implementation</a></h3>
<p>SCIM servers provide schema introspection endpoints:</p>
<ul>
<li><code>GET /Schemas</code> returns all registered schemas</li>
<li><code>GET /Schemas/{schema_id}</code> returns specific schema details</li>
<li>Enables automatic schema discovery for clients and tools</li>
</ul>
<h3 id="resource-type-discovery"><a class="header" href="#resource-type-discovery">Resource Type Discovery</a></h3>
<p>SCIM servers support resource type introspection as defined in RFC 7644:</p>
<p><code>GET /ResourceTypes</code> returns supported resource types, including:</p>
<ul>
<li>Resource endpoint paths</li>
<li>Associated schema URNs</li>
<li>Available schema extensions</li>
<li>Extension requirement status</li>
</ul>
<h2 id="dynamic-data-validation"><a class="header" href="#dynamic-data-validation">Dynamic Data Validation</a></h2>
<p>The schema system enables sophisticated validation that goes beyond simple type checking:</p>
<h3 id="multi-level-validation"><a class="header" href="#multi-level-validation">Multi-Level Validation</a></h3>
<p>SCIM validation occurs at multiple levels:</p>
<ol>
<li><strong>HTTP Method Validation</strong>: Operation-specific constraints</li>
<li><strong>Syntax Validation</strong>: JSON structure and basic type checking</li>
<li><strong>Schema Validation</strong>: Compliance with schema definitions</li>
<li><strong>Business Rule Validation</strong>: Custom validation logic</li>
</ol>
<p>The validation process ensures that data conforms to schema requirements before processing, returning appropriate HTTP status codes for different error types.</p>
<h3 id="operation-specific-validation"><a class="header" href="#operation-specific-validation">Operation-Specific Validation</a></h3>
<p>Each HTTP operation has specific validation requirements based on schema attribute properties:</p>
<ul>
<li><strong>POST (Create)</strong>: All required attributes must be present</li>
<li><strong>PUT (Replace)</strong>: Complete resource validation, immutable attributes cannot change</li>
<li><strong>PATCH (Update)</strong>: Path validation, readOnly attributes cannot be targeted</li>
<li><strong>GET (Read)</strong>: Response filtering based on "returned" attribute property</li>
</ul>
<h3 id="http-status-code-mapping"><a class="header" href="#http-status-code-mapping">HTTP Status Code Mapping</a></h3>
<p>Schema validation errors map to specific HTTP status codes:</p>
<ul>
<li><strong>400 Bad Request</strong>: Invalid values, missing required attributes, mutability violations</li>
<li><strong>409 Conflict</strong>: Uniqueness constraint violations</li>
<li><strong>412 Precondition Failed</strong>: ETag version mismatches</li>
</ul>
<h2 id="working-with-standard-data-definitions"><a class="header" href="#working-with-standard-data-definitions">Working with Standard Data Definitions</a></h2>
<p>SCIM defines standard data formats and constraints that the library enforces:</p>
<h3 id="attribute-types-and-constraints"><a class="header" href="#attribute-types-and-constraints">Attribute Types and Constraints</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Description</th><th>Validation Rules</th></tr></thead><tbody>
<tr><td><code>string</code></td><td>Text data</td><td>Length limits, case sensitivity, uniqueness</td></tr>
<tr><td><code>boolean</code></td><td>True/false values</td><td>Must be valid JSON boolean</td></tr>
<tr><td><code>decimal</code></td><td>Numeric data</td><td>Precision and scale constraints</td></tr>
<tr><td><code>integer</code></td><td>Whole numbers</td><td>Range validation</td></tr>
<tr><td><code>dateTime</code></td><td>ISO 8601 timestamps</td><td>Format and timezone validation</td></tr>
<tr><td><code>binary</code></td><td>Base64-encoded data</td><td>Encoding validation</td></tr>
<tr><td><code>reference</code></td><td>Resource references</td><td>Referential integrity checks</td></tr>
<tr><td><code>complex</code></td><td>Nested objects</td><td>Sub-attribute validation</td></tr>
</tbody></table>
</div>
<h3 id="multi-valued-attributes"><a class="header" href="#multi-valued-attributes">Multi-Valued Attributes</a></h3>
<p>SCIM supports multi-valued attributes with sophisticated handling:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L450-470">{
  "emails": [
    {
      "value": "primary@example.com",
      "type": "work", 
      "primary": true
    },
    {
      "value": "secondary@example.com",
      "type": "personal",
      "primary": false
    }
  ]
}
</code></pre>
<p><strong>Multi-Value Rules:</strong></p>
<ul>
<li>At most one <code>primary</code> value allowed</li>
<li>Type values from canonical list (if specified)</li>
<li>Duplicate detection and handling</li>
<li>Order preservation for client expectations</li>
</ul>
<h3 id="reference-attributes"><a class="header" href="#reference-attributes">Reference Attributes</a></h3>
<p>References to other SCIM resources are handled with full integrity checking:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L485-505">{
  "groups": [
    {
      "value": "e9e30dba-f08f-4109-8486-d5c6a331660a",
      "$ref": "https://example.com/scim/v2/Groups/e9e30dba-f08f-4109-8486-d5c6a331660a",
      "display": "Administrators"
    }
  ]
}

// The library validates:
// - Reference type matches schema constraints
// - Tenant isolation for multi-tenant systems
</code></pre>
<h2 id="http-content-negotiation-and-schema-processing"><a class="header" href="#http-content-negotiation-and-schema-processing">HTTP Content Negotiation and Schema Processing</a></h2>
<p>SCIM servers use HTTP headers to negotiate schema processing:</p>
<h3 id="content-type-and-schema-validation"><a class="header" href="#content-type-and-schema-validation">Content-Type and Schema Validation</a></h3>
<p>SCIM requests must include proper Content-Type headers and schema declarations:</p>
<pre><code>POST /Users HTTP/1.1
Content-Type: application/scim+json

{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
  "userName": "newuser@example.com"
}
</code></pre>
<p>Servers validate:</p>
<ul>
<li>Content-Type header matches SCIM specification (<code>application/scim+json</code>)</li>
<li>schemas array matches Content-Type expectations</li>
<li>Resource structure conforms to declared schemas</li>
</ul>
<h3 id="etag-and-schema-versioning"><a class="header" href="#etag-and-schema-versioning">ETag and Schema Versioning</a></h3>
<p>The SCIM protocol uses ETags (entity tags) for optimistic concurrency control, preventing lost updates when multiple clients modify the same resource. Each SCIM resource includes a <code>meta.version</code> field containing an ETag value that changes whenever the resource is modified. Clients use HTTP conditional headers (<code>If-Match</code>, <code>If-None-Match</code>) with these ETags to ensure they're operating on the expected version of a resource.</p>
<p>For implementation details and practical usage patterns, see the <a href="./concurrency.html">Concurrency Control in SCIM Operations</a> chapter and <a href="./schema-mechanisms.html">Schema Mechanisms in SCIM Server</a>.</p>
<h2 id="schema-extensibility-patterns"><a class="header" href="#schema-extensibility-patterns">Schema Extensibility Patterns</a></h2>
<p>The SCIM Server supports several patterns for extending schemas while maintaining interoperability:</p>
<h3 id="additive-extensions"><a class="header" href="#additive-extensions">Additive Extensions</a></h3>
<p>Add new attributes without modifying core schemas:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L520-540">// Core user data remains unchanged
{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User",
    "urn:example:params:scim:schemas:extension:acme:2.0:User"
  ],
  "userName": "alice.engineer",
  "emails": [{"value": "alice@acme.com", "primary": true}],
  
  // Extension data in separate namespace
  "urn:example:params:scim:schemas:extension:acme:2.0:User": {
    "department": "R&amp;D",
    "clearanceLevel": "SECRET",
    "projects": ["moonshot", "widget-2.0"]
  }
}
</code></pre>
<h3 id="schema-composition"><a class="header" href="#schema-composition">Schema Composition</a></h3>
<p>Combine multiple extensions for complex scenarios:</p>
<pre><code class="language-scim-server/docs/guide/src/concepts/schemas.md#L550-570">{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User",
    "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User", 
    "urn:example:params:scim:schemas:extension:security:2.0:User",
    "urn:example:params:scim:schemas:extension:hr:2.0:User"
  ],
  "userName": "bob.manager",
  
  // Each extension provides its own attributes
  "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User": {
    "employeeNumber": "E12345"
  },
  "urn:example:params:scim:schemas:extension:security:2.0:User": {
    "lastSecurityReview": "2024-01-15T10:30:00Z"
  },
  "urn:example:params:scim:schemas:extension:hr:2.0:User": {
    "performanceRating": "exceeds-expectations"
  }
}
</code></pre>
<h2 id="best-practices-for-schema-design"><a class="header" href="#best-practices-for-schema-design">Best Practices for Schema Design</a></h2>
<p>When designing custom schemas for use with SCIM Server:</p>
<h3 id="1-follow-naming-conventions"><a class="header" href="#1-follow-naming-conventions">1. Follow Naming Conventions</a></h3>
<ul>
<li>Use proper URN namespacing: <code>urn:example:params:scim:schemas:extension:company:version:Type</code></li>
<li>Choose descriptive attribute names that clearly indicate purpose</li>
<li>Use camelCase for attribute names to match SCIM conventions</li>
</ul>
<h3 id="2-design-for-interoperability"><a class="header" href="#2-design-for-interoperability">2. Design for Interoperability</a></h3>
<ul>
<li>Minimize custom types - prefer standard SCIM types when possible</li>
<li>Document extensions clearly for integration partners</li>
<li>Provide sensible defaults and make attributes optional when appropriate</li>
</ul>
<h3 id="3-consider-performance-implications"><a class="header" href="#3-consider-performance-implications">3. Consider Performance Implications</a></h3>
<ul>
<li>Avoid deeply nested complex attributes that are expensive to validate</li>
<li>Use appropriate uniqueness constraints to leverage database indexes</li>
<li>Consider query patterns when designing multi-valued attributes</li>
</ul>
<h3 id="4-plan-for-evolution"><a class="header" href="#4-plan-for-evolution">4. Plan for Evolution</a></h3>
<ul>
<li>Design extensible schemas that can accommodate future requirements</li>
<li>Use semantic versioning for schema URNs</li>
<li>Maintain backwards compatibility when modifying existing schemas</li>
</ul>
<h2 id="integration-with-ai-systems"><a class="header" href="#integration-with-ai-systems">Integration with AI Systems</a></h2>
<p>The SCIM Server's schema system is designed to work seamlessly with AI agents through the Model Context Protocol (MCP):</p>
<h3 id="schema-aware-ai-tools"><a class="header" href="#schema-aware-ai-tools">Schema-Aware AI Tools</a></h3>
<p>SCIM schemas enable AI integration by providing structured descriptions of available operations and data formats. AI systems can discover schema capabilities and generate compliant requests automatically.</p>
<p>Schema information that benefits AI systems includes:</p>
<ul>
<li>Required and optional attributes for each resource type</li>
<li>Validation rules and data format constraints</li>
<li>Available HTTP operations and their requirements</li>
<li>Extension schemas and custom attribute definitions</li>
</ul>
<p>For implementation details, see <a href="./schema-mechanisms.html">Schema Mechanisms in SCIM Server</a> and the <a href="../advanced/ai-integration.html">AI Integration Guide</a>.</p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<h2 id="conclusion-1"><a class="header" href="#conclusion-1">Conclusion</a></h2>
<p>SCIM schemas provide a powerful foundation for identity data management that balances standardization with extensibility across HTTP REST operations. Understanding these protocol concepts enables you to:</p>
<ul>
<li><strong>Design compliant SCIM resources</strong> that work with enterprise identity providers</li>
<li><strong>Implement proper validation</strong> across all HTTP operations</li>
<li><strong>Create extensible systems</strong> using schema extension mechanisms</li>
<li><strong>Build interoperable solutions</strong> that follow RFC specifications</li>
<li><strong>Support diverse client requirements</strong> through schema discovery</li>
</ul>
<p>Key takeaways include:</p>
<ul>
<li><strong>Schema Structure</strong>: Schemas define both data structure and operational behavior</li>
<li><strong>HTTP Integration</strong>: Each REST operation has specific schema processing requirements</li>
<li><strong>Extensibility</strong>: Extension schemas enable customization while maintaining compatibility</li>
<li><strong>Validation</strong>: Multi-layered validation ensures data integrity and compliance</li>
<li><strong>Discovery</strong>: Schema endpoints enable dynamic client capabilities</li>
</ul>
<p>For practical implementation of these concepts using the SCIM Server library, see <a href="./schema-mechanisms.html">Schema Mechanisms in SCIM Server</a>.</p>
<p>The next chapter will explore hands-on implementation patterns and real-world usage scenarios.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../architecture.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../concepts/schema-mechanisms.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../architecture.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../concepts/schema-mechanisms.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
