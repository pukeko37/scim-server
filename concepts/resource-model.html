<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Resource Model - SCIM Server Guide</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SCIM Server Guide</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="resource-model"><a class="header" href="#resource-model">Resource Model</a></h1>
<p>The SCIM Server's resource model provides a type-safe, extensible foundation for identity management. This chapter explains how resources work, how to customize them, and how the type system prevents common errors.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>In SCIM, everything is a <strong>resource</strong> - users, groups, and custom objects all follow the same fundamental patterns. The SCIM Server library models these as Rust types that provide compile-time safety while maintaining runtime flexibility.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use scim_server::{ScimUser, ScimGroup, ScimResource};

// Type-safe resource creation
let user = ScimUser::builder()
    .username("alice@example.com")
    .given_name("Alice")
    .family_name("Johnson")
    .email("alice@example.com")
    .build()?;

// Compile-time guarantees
let id = user.id(); // Always returns a valid UUID
let version = user.version(); // ETag for concurrency control
<span class="boring">}</span></code></pre></pre>
<p>This design provides the flexibility of JSON with the safety of Rust's type system.</p>
<h2 id="core-resource-structure"><a class="header" href="#core-resource-structure">Core Resource Structure</a></h2>
<h3 id="base-resource-traits"><a class="header" href="#base-resource-traits">Base Resource Traits</a></h3>
<p>All SCIM resources implement the <code>ScimResource</code> trait:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub trait ScimResource {
    fn id(&amp;self) -&gt; &amp;str;
    fn schemas(&amp;self) -&gt; &amp;[String];
    fn meta(&amp;self) -&gt; &amp;ResourceMeta;
    fn external_id(&amp;self) -&gt; Option&lt;&amp;str&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="resource-metadata"><a class="header" href="#resource-metadata">Resource Metadata</a></h3>
<p>Every resource includes metadata for versioning and auditing:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct ResourceMeta {
    pub resource_type: String,
    pub created: DateTime&lt;Utc&gt;,
    pub last_modified: DateTime&lt;Utc&gt;,
    pub version: String,  // ETag for concurrency control
    pub location: Option&lt;String&gt;,
}
<span class="boring">}</span></code></pre></pre>
<p>The metadata is automatically managed by the SCIM Server:</p>
<pre><code class="language-json">{
  "meta": {
    "resourceType": "User",
    "created": "2023-12-01T10:30:00Z",
    "lastModified": "2023-12-01T15:45:00Z",
    "version": "W/\"3694e05e9dff590\"",
    "location": "https://api.example.com/scim/v2/Users/123"
  }
}
</code></pre>
<h2 id="user-resources"><a class="header" href="#user-resources">User Resources</a></h2>
<h3 id="core-user-attributes"><a class="header" href="#core-user-attributes">Core User Attributes</a></h3>
<p>The <code>ScimUser</code> type models the standard SCIM user schema:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use scim_server::{ScimUser, Name, Email, PhoneNumber};

let user = ScimUser::builder()
    .username("bjensen@example.com")
    .name(Name {
        formatted: Some("Ms. Barbara J Jensen III".to_string()),
        family_name: Some("Jensen".to_string()),
        given_name: Some("Barbara".to_string()),
        middle_name: Some("Jane".to_string()),
        honorific_prefix: Some("Ms.".to_string()),
        honorific_suffix: Some("III".to_string()),
    })
    .display_name("Babs Jensen")
    .nick_name("Babs")
    .profile_url("https://login.example.com/bjensen")
    .email(Email {
        value: "bjensen@example.com".to_string(),
        type_: Some("work".to_string()),
        primary: Some(true),
    })
    .phone_number(PhoneNumber {
        value: "+1-555-555-8377".to_string(),
        type_: Some("work".to_string()),
        primary: Some(true),
    })
    .active(true)
    .build()?;
<span class="boring">}</span></code></pre></pre>
<h3 id="multi-value-attributes"><a class="header" href="#multi-value-attributes">Multi-Value Attributes</a></h3>
<p>SCIM supports multi-value attributes for emails, phone numbers, and addresses:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let user = ScimUser::builder()
    .username("alice@example.com")
    .emails(vec![
        Email {
            value: "alice@work.com".to_string(),
            type_: Some("work".to_string()),
            primary: Some(true),
        },
        Email {
            value: "alice@personal.com".to_string(),
            type_: Some("home".to_string()),
            primary: Some(false),
        },
    ])
    .phone_numbers(vec![
        PhoneNumber {
            value: "+1-555-555-1234".to_string(),
            type_: Some("work".to_string()),
            primary: Some(true),
        },
        PhoneNumber {
            value: "+1-555-555-5678".to_string(),
            type_: Some("mobile".to_string()),
            primary: Some(false),
        },
    ])
    .build()?;
<span class="boring">}</span></code></pre></pre>
<h3 id="enterprise-extensions"><a class="header" href="#enterprise-extensions">Enterprise Extensions</a></h3>
<p>For enterprise environments, SCIM provides additional attributes:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use scim_server::{ScimUser, EnterpriseUser};

let user = ScimUser::builder()
    .username("alice@example.com")
    .given_name("Alice")
    .family_name("Johnson")
    .enterprise(EnterpriseUser {
        employee_number: Some("12345".to_string()),
        cost_center: Some("Engineering".to_string()),
        organization: Some("ACME Corp".to_string()),
        division: Some("Technology".to_string()),
        department: Some("Software Development".to_string()),
        manager: Some(Manager {
            value: "manager-id-456".to_string(),
            ref_: Some("../Users/manager-id-456".to_string()),
            display_name: Some("Bob Smith".to_string()),
        }),
    })
    .build()?;
<span class="boring">}</span></code></pre></pre>
<h2 id="group-resources"><a class="header" href="#group-resources">Group Resources</a></h2>
<h3 id="basic-group-structure"><a class="header" href="#basic-group-structure">Basic Group Structure</a></h3>
<p>Groups represent collections of users with optional hierarchical relationships:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use scim_server::{ScimGroup, GroupMember};

let group = ScimGroup::builder()
    .display_name("Engineering Team")
    .members(vec![
        GroupMember {
            value: "user-id-123".to_string(),
            ref_: Some("../Users/user-id-123".to_string()),
            type_: Some("User".to_string()),
            display: Some("Alice Johnson".to_string()),
        },
        GroupMember {
            value: "user-id-456".to_string(),
            ref_: Some("../Users/user-id-456".to_string()),
            type_: Some("User".to_string()),
            display: Some("Bob Smith".to_string()),
        },
    ])
    .build()?;
<span class="boring">}</span></code></pre></pre>
<h3 id="nested-groups"><a class="header" href="#nested-groups">Nested Groups</a></h3>
<p>Groups can contain other groups for hierarchical organization:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let parent_group = ScimGroup::builder()
    .display_name("All Engineering")
    .members(vec![
        GroupMember {
            value: "group-frontend".to_string(),
            ref_: Some("../Groups/group-frontend".to_string()),
            type_: Some("Group".to_string()),
            display: Some("Frontend Team".to_string()),
        },
        GroupMember {
            value: "group-backend".to_string(),
            ref_: Some("../Groups/group-backend".to_string()),
            type_: Some("Group".to_string()),
            display: Some("Backend Team".to_string()),
        },
    ])
    .build()?;
<span class="boring">}</span></code></pre></pre>
<h2 id="schema-system"><a class="header" href="#schema-system">Schema System</a></h2>
<h3 id="schema-definition"><a class="header" href="#schema-definition">Schema Definition</a></h3>
<p>Schemas define the structure and validation rules for resources:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use scim_server::{Schema, Attribute, AttributeType, Mutability, Returned};

let user_schema = Schema::builder()
    .id("urn:ietf:params:scim:schemas:core:2.0:User")
    .name("User")
    .description("User Account")
    .attribute(
        Attribute::builder()
            .name("userName")
            .type_(AttributeType::String)
            .mutability(Mutability::ReadWrite)
            .returned(Returned::Default)
            .uniqueness(true)
            .required(true)
            .case_exact(false)
            .build()
    )
    .attribute(
        Attribute::builder()
            .name("name")
            .type_(AttributeType::Complex)
            .mutability(Mutability::ReadWrite)
            .returned(Returned::Default)
            .sub_attribute(
                Attribute::builder()
                    .name("givenName")
                    .type_(AttributeType::String)
                    .mutability(Mutability::ReadWrite)
                    .build()
            )
            .build()
    )
    .build()?;
<span class="boring">}</span></code></pre></pre>
<h3 id="dynamic-schema-registry"><a class="header" href="#dynamic-schema-registry">Dynamic Schema Registry</a></h3>
<p>The SCIM Server maintains a registry of available schemas:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use scim_server::{SchemaRegistry, CoreSchemas};

let mut registry = SchemaRegistry::new();

// Register core schemas
registry.register(CoreSchemas::user());
registry.register(CoreSchemas::group());
registry.register(CoreSchemas::enterprise_user());

// Register custom schemas
registry.register(custom_department_schema());

// Validate resources against schemas
let validation_result = registry.validate_user(&amp;user)?;
<span class="boring">}</span></code></pre></pre>
<h2 id="custom-resources"><a class="header" href="#custom-resources">Custom Resources</a></h2>
<h3 id="defining-custom-resource-types"><a class="header" href="#defining-custom-resource-types">Defining Custom Resource Types</a></h3>
<p>You can extend SCIM with custom resource types:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use scim_server::{ScimResource, ResourceMeta};
use serde::{Deserialize, Serialize};

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct Project {
    pub id: String,
    pub schemas: Vec&lt;String&gt;,
    pub meta: ResourceMeta,
    pub external_id: Option&lt;String&gt;,
    
    // Custom attributes
    pub name: String,
    pub description: Option&lt;String&gt;,
    pub owner: String,
    pub status: ProjectStatus,
    pub created_date: DateTime&lt;Utc&gt;,
    pub budget: Option&lt;f64&gt;,
    pub team_members: Vec&lt;String&gt;,
}

#[derive(Debug, Clone, Serialize, Deserialize)]
pub enum ProjectStatus {
    Planning,
    Active,
    OnHold,
    Completed,
    Cancelled,
}

impl ScimResource for Project {
    fn id(&amp;self) -&gt; &amp;str {
        &amp;self.id
    }
    
    fn schemas(&amp;self) -&gt; &amp;[String] {
        &amp;self.schemas
    }
    
    fn meta(&amp;self) -&gt; &amp;ResourceMeta {
        &amp;self.meta
    }
    
    fn external_id(&amp;self) -&gt; Option&lt;&amp;str&gt; {
        self.external_id.as_deref()
    }
}
<span class="boring">}</span></code></pre></pre>
<h3 id="custom-schema-definition"><a class="header" href="#custom-schema-definition">Custom Schema Definition</a></h3>
<p>Define the schema for your custom resource:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn project_schema() -&gt; Schema {
    Schema::builder()
        .id("urn:company:params:scim:schemas:core:2.0:Project")
        .name("Project")
        .description("Project Management Resource")
        .attribute(
            Attribute::builder()
                .name("name")
                .type_(AttributeType::String)
                .mutability(Mutability::ReadWrite)
                .returned(Returned::Default)
                .required(true)
                .case_exact(false)
                .build()
        )
        .attribute(
            Attribute::builder()
                .name("status")
                .type_(AttributeType::String)
                .mutability(Mutability::ReadWrite)
                .returned(Returned::Default)
                .canonical_values(vec![
                    "Planning".to_string(),
                    "Active".to_string(),
                    "OnHold".to_string(),
                    "Completed".to_string(),
                    "Cancelled".to_string(),
                ])
                .build()
        )
        .build()
        .unwrap()
}
<span class="boring">}</span></code></pre></pre>
<h2 id="type-safety-features"><a class="header" href="#type-safety-features">Type Safety Features</a></h2>
<h3 id="compile-time-validation"><a class="header" href="#compile-time-validation">Compile-Time Validation</a></h3>
<p>The type system prevents many common errors:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// ✅ This compiles - valid email
let user = ScimUser::builder()
    .email("alice@example.com")
    .build()?;

// ❌ This won't compile - wrong type
let user = ScimUser::builder()
    .email(123)  // Error: expected String, found integer
    .build()?;
<span class="boring">}</span></code></pre></pre>
<h3 id="builder-pattern-safety"><a class="header" href="#builder-pattern-safety">Builder Pattern Safety</a></h3>
<p>The builder pattern ensures required fields are provided:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// ✅ This compiles - username is required and provided
let user = ScimUser::builder()
    .username("alice@example.com")
    .build()?;

// ❌ This won't compile - missing required username
let user = ScimUser::builder()
    .given_name("Alice")
    .build()?;  // Error: username is required
<span class="boring">}</span></code></pre></pre>
<h3 id="option-types-for-optional-fields"><a class="header" href="#option-types-for-optional-fields">Option Types for Optional Fields</a></h3>
<p>Optional fields use Rust's <code>Option</code> type:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let user = ScimUser::builder()
    .username("alice@example.com")
    .given_name("Alice")  // Option&lt;String&gt; - automatically wrapped
    .middle_name(None)    // Explicitly no middle name
    .family_name(Some("Johnson".to_string()))  // Explicitly provided
    .build()?;

// Safe access to optional fields
match user.middle_name() {
    Some(middle) =&gt; println!("Middle name: {}", middle),
    None =&gt; println!("No middle name provided"),
}
<span class="boring">}</span></code></pre></pre>
<h2 id="validation-and-constraints"><a class="header" href="#validation-and-constraints">Validation and Constraints</a></h2>
<h3 id="built-in-validation"><a class="header" href="#built-in-validation">Built-in Validation</a></h3>
<p>The SCIM Server provides automatic validation:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use scim_server::{ScimUser, ValidationError};

// Email format validation
let result = ScimUser::builder()
    .username("invalid-email")  // Missing @ symbol
    .build();

match result {
    Ok(user) =&gt; println!("User created: {}", user.username()),
    Err(ValidationError::InvalidEmail(email)) =&gt; {
        println!("Invalid email format: {}", email);
    },
    Err(e) =&gt; println!("Other validation error: {}", e),
}
<span class="boring">}</span></code></pre></pre>
<h3 id="custom-validation-rules"><a class="header" href="#custom-validation-rules">Custom Validation Rules</a></h3>
<p>Add your own validation logic:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl ScimUser {
    pub fn validate_business_rules(&amp;self) -&gt; Result&lt;(), ValidationError&gt; {
        // Custom rule: work emails must be from company domain
        if let Some(work_email) = self.work_email() {
            if !work_email.ends_with("@company.com") {
                return Err(ValidationError::InvalidWorkEmail);
            }
        }
        
        // Custom rule: employee number format
        if let Some(employee_number) = self.employee_number() {
            if !employee_number.starts_with("EMP") {
                return Err(ValidationError::InvalidEmployeeNumber);
            }
        }
        
        Ok(())
    }
}
<span class="boring">}</span></code></pre></pre>
<h2 id="serialization-and-json"><a class="header" href="#serialization-and-json">Serialization and JSON</a></h2>
<h3 id="automatic-json-serialization"><a class="header" href="#automatic-json-serialization">Automatic JSON Serialization</a></h3>
<p>Resources automatically serialize to SCIM-compliant JSON:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use serde_json;

let user = ScimUser::builder()
    .username("alice@example.com")
    .given_name("Alice")
    .family_name("Johnson")
    .build()?;

let json = serde_json::to_string_pretty(&amp;user)?;
println!("{}", json);
<span class="boring">}</span></code></pre></pre>
<p>Output:</p>
<pre><code class="language-json">{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
  "id": "2819c223-7f76-453a-919d-413861904646",
  "userName": "alice@example.com",
  "name": {
    "givenName": "Alice",
    "familyName": "Johnson"
  },
  "meta": {
    "resourceType": "User",
    "created": "2023-12-01T10:30:00Z",
    "lastModified": "2023-12-01T10:30:00Z",
    "version": "W/\"1\""
  }
}
</code></pre>
<h3 id="json-deserialization"><a class="header" href="#json-deserialization">JSON Deserialization</a></h3>
<p>Parse JSON into type-safe resources:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let json = r#"
{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
  "userName": "alice@example.com",
  "name": {
    "givenName": "Alice",
    "familyName": "Johnson"
  }
}
"#;

let user: ScimUser = serde_json::from_str(json)?;
println!("User: {} {}", user.given_name(), user.family_name());
<span class="boring">}</span></code></pre></pre>
<h2 id="performance-considerations"><a class="header" href="#performance-considerations">Performance Considerations</a></h2>
<h3 id="memory-efficiency"><a class="header" href="#memory-efficiency">Memory Efficiency</a></h3>
<p>The resource model is designed for efficiency:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Zero-copy string references where possible
impl ScimUser {
    pub fn username(&amp;self) -&gt; &amp;str {  // Returns reference, not owned String
        &amp;self.username
    }
    
    pub fn display_name(&amp;self) -&gt; Option&lt;&amp;str&gt; {  // Optional reference
        self.display_name.as_deref()
    }
}
<span class="boring">}</span></code></pre></pre>
<h3 id="lazy-loading"><a class="header" href="#lazy-loading">Lazy Loading</a></h3>
<p>Complex attributes can be loaded on demand:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Only load enterprise attributes when needed
impl ScimUser {
    pub fn enterprise(&amp;self) -&gt; Option&lt;&amp;EnterpriseUser&gt; {
        self.enterprise.as_ref()
    }
    
    pub fn load_enterprise(&amp;mut self, provider: &amp;impl Provider) -&gt; Result&lt;(), Error&gt; {
        if self.enterprise.is_none() {
            self.enterprise = provider.load_enterprise_data(&amp;self.id)?;
        }
        Ok(())
    }
}
<span class="boring">}</span></code></pre></pre>
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<h3 id="resource-creation"><a class="header" href="#resource-creation">Resource Creation</a></h3>
<p><strong>Use builders for complex resources</strong>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let user = ScimUser::builder()
    .username("alice@example.com")
    .given_name("Alice")
    .family_name("Johnson")
    .email("alice@example.com")
    .active(true)
    .build()?;
<span class="boring">}</span></code></pre></pre>
<p><strong>Validate early and often</strong>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Validate during creation
let user = ScimUser::builder()
    .username("alice@example.com")
    .validate()  // Explicit validation
    .build()?;

// Validate before persistence
user.validate_business_rules()?;
provider.create_user(user)?;
<span class="boring">}</span></code></pre></pre>
<h3 id="schema-management"><a class="header" href="#schema-management">Schema Management</a></h3>
<p><strong>Register schemas at startup</strong>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn setup_schemas(registry: &amp;mut SchemaRegistry) {
    registry.register(CoreSchemas::user());
    registry.register(CoreSchemas::group());
    registry.register(custom_project_schema());
}
<span class="boring">}</span></code></pre></pre>
<p><strong>Version your custom schemas</strong>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>const PROJECT_SCHEMA_V1: &amp;str = "urn:company:scim:schemas:project:1.0";
const PROJECT_SCHEMA_V2: &amp;str = "urn:company:scim:schemas:project:2.0";
<span class="boring">}</span></code></pre></pre>
<h3 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h3>
<p><strong>Handle validation errors gracefully</strong>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>match ScimUser::builder().username("invalid").build() {
    Ok(user) =&gt; process_user(user),
    Err(ValidationError::InvalidUsername(username)) =&gt; {
        log::warn!("Invalid username format: {}", username);
        return_error_response("Invalid username format");
    },
    Err(e) =&gt; {
        log::error!("Unexpected validation error: {}", e);
        return_error_response("Internal validation error");
    }
}
<span class="boring">}</span></code></pre></pre>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<p>Now that you understand the resource model, you're ready to:</p>
<ol>
<li><strong><a href="./multi-tenancy.html">Learn about multi-tenancy</a></strong> for isolating resources</li>
<li><strong><a href="./providers.html">Explore storage providers</a></strong> for persistence</li>
<li><strong><a href="./etag-concurrency.html">Understand ETag concurrency</a></strong> for safe updates</li>
<li><strong><a href="../tutorials/custom-resources.html">Build custom resources</a></strong> for your domain</li>
</ol>
<p>The resource model provides the foundation for type-safe SCIM operations. Combined with Rust's ownership system, it prevents many classes of runtime errors while maintaining the flexibility needed for diverse identity management scenarios.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../concepts/architecture.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../concepts/multi-tenancy.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../concepts/architecture.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../concepts/multi-tenancy.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
